<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin — ANKÜCaz</title>

  <link rel="stylesheet" href="style.css" />

  <style>
    .admin-page { padding-top: 16px; padding-bottom: 24px; }

    .admin-hero{
      max-width: 1100px;
      margin: 0 auto 14px;
      padding: 14px 14px 0;
    }
    .admin-hero h1{ margin: 0; font-size: 28px; letter-spacing: .2px; }
    .admin-hero p{ margin: 6px 0 0; opacity: .8; }

    .admin-grid{
      max-width: 1100px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 14px;
      padding: 14px;
    }
    @media (max-width: 920px){
      .admin-grid{ grid-template-columns: 1fr; }
      .admin-span-2{ grid-column: auto; }
    }

    .admin-card{
      border-radius: 16px;
      padding: 14px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(8px);
    }
    .admin-span-2{ grid-column: 1 / -1; }

    .card-head{ margin-bottom: 10px; }
    .card-head h2{ margin: 0; font-size: 16px; }
    .card-head p{ margin: 6px 0 0; font-size: 12px; opacity: .8; }

    .form-grid{
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    .form-field{ display: flex; flex-direction: column; gap: 6px; }
    .form-field.full{ grid-column: 1 / -1; }

    .admin-card label{ font-size: 12px; opacity: .85; }
    .admin-card input, .admin-card textarea, .admin-card select{
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      color: inherit;
      outline: none;
    }
    .admin-card textarea{ resize: vertical; min-height: 110px; }

    .btn-row{
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .btn{
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.08);
      color: inherit;
      cursor: pointer;
      font-weight: 700;
    }
    .btn:hover{ filter: brightness(1.06); }
    .btn.primary{
      border: none;
      background: linear-gradient(135deg, rgba(120,80,255,.95), rgba(0,200,255,.65));
    }
    .btn.ghost{ background: transparent; }

    /* list */
    #eventsList, #announcementsList, #regsList, #staffKeysList{
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 10px;
    }

    .muted{ opacity: .8; font-size: 12px; margin-top: 8px; }
    .result{ margin-top: 10px; }

    /* ✅ default kapalı */
    [data-section] { display: none; }
    [data-section].is-visible { display: block; }
  </style>
</head>
<body>

<header>
  <div class="container">
    <div class="logo-box">
      <img src="images/logo.png" class="logo" alt="ANKÜCaz Logo">
      <span class="logo-text">ANKÜcaz</span>
    </div>
    <nav>
      <ul>
        <li><a href="index.html">Siteye Dön</a></li>
      </ul>
    </nav>
  </div>
</header>

<section class="section admin-page">
  <div class="admin-hero">
    <h1>Admin Panel</h1>
    <p>Etkinlik • Duyuru • Kayıt • Key Yönetimi</p>
  </div>

  <div class="admin-grid">

    <!-- LOGIN (HER ZAMAN GÖRÜNÜR) -->
    <div class="admin-card admin-span-2">
      <div class="form-grid">
        <div class="form-field">
          <label>Admin Key (X-ADMIN-KEY)</label>
          <input id="adminKey" type="password" placeholder="Örn: ankucaz-admin-123" />
          <button id="loginAdmin" class="btn primary" type="button">Admin Giriş</button>
        </div>

        <div class="form-field">
          <label>Staff Key (X-STAFF-KEY)</label>
          <input id="staffKey" type="password" placeholder="ank_..." />
          <button id="loginStaff" class="btn primary" type="button">Staff Giriş</button>
        </div>
      </div>

      <div class="btn-row">
        <button id="logout" class="btn ghost" type="button">Çıkış</button>
        <span id="keyStatus" class="muted"></span>
      </div>

      <div class="muted">İpucu: Key’ler localStorage’da saklanır.</div>
    </div>

    <!-- KEY MANAGEMENT (SADECE ADMIN) -->
    <div class="admin-card admin-span-2" data-section="keys">
      <div class="card-head">
        <h2>Yetki / Key Yönetimi</h2>
        <p>Admin key ile staff key üret, listele, pasifleştir.</p>
      </div>

      <!-- ⚠️ submit yok: refresh asla olmayacak -->
      <div class="form-grid">
        <div class="form-field">
          <label>İsim</label>
          <input id="staffName" placeholder="Örn: Etkinlik Ekibi / Tuğrul" />
        </div>
        <div class="form-field">
          <label>Rol</label>
          <select id="staffRole">
            <option value="viewer">viewer (sadece kayıt)</option>
            <option value="organizer">organizer (event + duyuru)</option>
            <option value="admin">admin (her şey)</option>
          </select>
        </div>

        <div class="form-field full">
          <div class="btn-row">
            <button type="button" id="createStaffKeyBtn" class="btn primary">Yeni Key Oluştur</button>
            <button type="button" id="refreshKeys" class="btn">Listeyi Yenile</button>
          </div>
        </div>
      </div>

      <div class="admin-card" style="margin-top:12px; background: rgba(0,0,0,.12);">
        <div class="card-head">
          <h2 style="font-size:14px;">Yeni Oluşturulan Key</h2>
          <p>Bu key bir daha gösterilmez. Kopyala.</p>
        </div>
        <div class="form-grid">
          <div class="form-field full">
            <label>Key</label>
            <input id="generatedKey" readonly />
          </div>
          <div class="form-field full">
            <button type="button" id="copyGeneratedKey" class="btn">Kopyala</button>
            <span id="generatedKeyStatus" class="muted" style="margin-left:10px;"></span>
          </div>
        </div>
      </div>

      <div style="margin-top:12px;">
        <div class="card-head">
          <h2 style="font-size:14px;">Mevcut Key’ler</h2>
        </div>
        <div id="staffKeysList"></div>
      </div>
    </div>

    <!-- DUYURULAR -->
    <div class="admin-card" data-section="announcements">
      <div class="card-head">
        <h2>Duyurular</h2>
        <p>Listele / düzenle / sil.</p>
      </div>
      <div id="announcementsList"></div>
    </div>

    <div class="admin-card" data-section="announcements">
      <div class="card-head">
        <h2>Duyuru Ekle / Düzenle</h2>
      </div>

      <form id="announcementForm">
        <input type="hidden" id="announcementId" />
        <div class="form-grid">
          <div class="form-field full">
            <label>Başlık</label>
            <input id="aTitle" required />
          </div>
          <div class="form-field full">
            <label>İçerik</label>
            <textarea id="aContent" required></textarea>
          </div>
          <div class="form-field full">
            <div class="btn-row">
              <button type="submit" class="btn primary">Kaydet</button>
              <button type="button" id="resetAnnouncementForm" class="btn ghost">Yeni</button>
            </div>
          </div>
        </div>
      </form>

      <p id="announcementResult" class="result"></p>
    </div>

    <!-- EVENTS -->
    <div class="admin-card" data-section="events">
      <div class="card-head">
        <h2>Etkinlikler</h2>
        <p>Listele / düzenle / sil.</p>
      </div>
      <div id="eventsList"></div>
    </div>

    <div class="admin-card" data-section="events">
      <div class="card-head">
        <h2>Etkinlik Ekle / Düzenle</h2>
      </div>

      <form id="eventForm">
        <input type="hidden" id="eventId" />
        <div class="form-grid">
          <div class="form-field full">
            <label>Başlık</label>
            <input id="title" required />
          </div>
          <div class="form-field full">
            <label>Açıklama</label>
            <textarea id="description" required></textarea>
          </div>
          <div class="form-field">
            <label>Başlangıç</label>
            <input id="startDate" type="datetime-local" required />
          </div>
          <div class="form-field">
            <label>Bitiş</label>
            <input id="endDate" type="datetime-local" required />
          </div>
          <div class="form-field full">
            <div class="btn-row">
              <button type="submit" class="btn primary">Kaydet</button>
              <button type="button" id="resetForm" class="btn ghost">Yeni</button>
            </div>
          </div>
        </div>
      </form>

      <p id="result" class="result"></p>
    </div>

    <!-- REGISTRATIONS -->
    <div class="admin-card admin-span-2" data-section="registrations">
      <div class="card-head">
        <h2>Kayıtlar</h2>
        <p>Etkinliğe kayıt yapan kişiler.</p>
      </div>

      <div class="form-grid">
        <div class="form-field">
          <label>EventId</label>
          <input id="regEventId" type="number" placeholder="Örn: 1" />
        </div>
        <div class="form-field" style="justify-content:end;">
          <label style="opacity:0;">_</label>
          <button id="loadRegs" class="btn primary" type="button">Kayıtları Getir</button>
        </div>
        <div class="form-field full">
          <div id="regsList"></div>
        </div>
      </div>
    </div>

  </div>
</section>

<footer>
  <p>© 2025 ANKÜcaz</p>
</footer>

<!-- cache bust -->
<script src="js/admin.js?v=10"></script>
</body>
</html>
